function jq(e) { var t = document.createElement("script"); t.setAttribute("src", "js/jquery-1.10.1.min.js"), t.addEventListener("load", function () { var t = document.createElement("script"); t.textContent = "(" + e.toString() + ")();", document.body.appendChild(t) }, !1), document.body.appendChild(t) } function main() { jQuery.noConflict(); var e = { ss: 0, se: 0 }; setInterval(function () { jQuery("input").each(function () { jQuery(this).attr("taed") || (jQuery(this).attr("taed", "true"), jQuery(this).attr("x-webkit-speech", "true")) }), jQuery("textarea:visible, *[g_editable='true']").each(function () { if (!jQuery(this).attr("taed")) { var t = jQuery(this); t.blur(function () { e = { time: (new Date).getTime(), elt: t[0], ss: t[0].selectionStart, se: t[0].selectionEnd } }), t.attr("taed", "true"); var n = jQuery("<input type='text' size='1' x-webkit-speech></input>"); n.css({ position: "absolute", background: "none", left: t.offset().left + t.width() - 20, top: t.offset().top, width: 15, border: "0px" }), jQuery("body").append(n), n.click(function () { (t[0] != e.elt || (new Date).getTime() - t.time > 100) && (e.ss = e.se = t.val().length) }), setInterval(function () { if (n.css({ left: t.offset().left + t.width() - 8, top: t.offset().top }), "" != n.val()) { if (n.val(n.val() + " "), "textarea" === t[0].tagName.toLowerCase()) { var i = t.val(); t.val(i.substr(0, e.ss) + n.val() + i.substr(e.se)), t.focus(); var a = n.val().length; e.se == e.ss ? t[0].selectionStart = t[0].selectionEnd = e.ss + a : (t[0].selectionStart = e.ss, t[0].selectionEnd = e.ss + a) } else t.attr("g_editable") && t.html(t.html() + n.val()); n.val("") } }, 100) } }) }, 1e3) } jq(main);